from langchain.prompts import PromptTemplate

# Prompt 1: RAG 查询构造
prompt1 = PromptTemplate.from_template(
    "你是一名日志分析专家。用户输入了一条日志：{log_entry}。\n"
    "请生成适合检索的查询关键词，以帮助在日志数据库中找到相关的历史记录。\n"
    "返回一个适合查询的简洁句子，不需要额外解释。"
)

# Prompt 2: 大模型安全分析
prompt2 = PromptTemplate.from_template(
    "你是一名网络安全专家，需要分析日志数据中的安全威胁。\n"
    "请分析用户提供的日志，并将相关历史日志作为参考，判断用户提供的日志是否存在潜在的安全风险。\n"
    "用户提供的日志：{log_entry}\n"
    "检索到的相关历史日志：{retrieved_logs}\n"
    "其中level代表该条相关日志的危险程度，1为低危、2为中危、3为高危。\n"
    "要求：分析时重点关注用户提供的日志，相关日志只作为参考，不要输出对历史日志的分析，只输出对用户提供日志的分析。\n"
    "输出请严格按照返回格式（不要重复输入内容，直接生成分析结果）：\n"
    "1. **是否有风险（是/否）**\n"
    "2. **风险等级（低/中/高）**\n"
    "3. **分析原因（100字以内）**\n"
)
# "*上面输出完毕之后，不要输出其他内容！*\n"

# Prompt 3: 大模型安全分析(无检索)
prompt3 = PromptTemplate.from_template(
    "你是一名网络安全专家，需要分析日志数据中的安全威胁。\n"
    "请分析用户提供的日志，判断用户提供的日志是否存在潜在的安全风险。\n"
    "用户提供的日志：{log_entry}\n"
    "输出请严格按照返回格式（不要重复输入内容，直接生成分析结果）：\n"
    "1. **是否有风险（是/否）**\n"
    "2. **风险等级（低/中/高）**\n"
    "3. **分析原因（100字以内）**\n"
)